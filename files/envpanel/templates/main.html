<!--
  Copyright(c) 2017 Radek Kaczorek  <rkaczorek AT gmail DOT com>

 This library is free software; you can redistribute it and/or
 modify it under the terms of the GNU Library General Public
 License version 2 as published by the Free Software Foundation.

 This library is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 Library General Public License for more details.

 You should have received a copy of the GNU Library General Public License
 along with this library; see the file COPYING.LIB.  If not, write to
 the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
 Boston, MA 02110-1301, USA.
-->

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<meta http-equiv="Content-Language" content="en,en-us"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environment & Status</title>
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="assets/css/style.css" rel="stylesheet">
    <script src="assets/js/jquery-3.4.1.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/socket.io.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
	var url = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port: '');
	var socket = io.connect(url, { path: location.pathname + 'socket.io' });
	socket.on('environdata', function(env) {
			if (env.temperature) {
				$("#temperature").attr("src", "data:image/png;base64," + env.temperature);
			}

			if (env.pressure) {
				$("#pressure").attr("src", "data:image/png;base64," + env.pressure);
			}

			if (env.humidity) {
				$("#humidity").attr("src", "data:image/png;base64," + env.humidity);
			}

			if (env.voltage) {
				$("#powvoltage").attr("src", "data:image/png;base64," + env.voltage);
			}

			if (env.current) {
				$("#powcurrent").attr("src", "data:image/png;base64," + env.current);
			}

			if (env.power) {
				$("#powpower").attr("src", "data:image/png;base64," + env.power);
			}

			if (env.percents) {
				$("#raspipercentages").attr("src", "data:image/png;base64," + env.percents);
			}

			if (env.loads) {
				$("#raspiloads").attr("src", "data:image/png;base64," + env.loads);
			}

			if (env.cputemp) {
				$("#cputemp").attr("src", "data:image/png;base64," + env.cputemp);
			}
		});
	});
    </script>
</head>
<body onload="togglepower()">
	<div class="panel_container">
		<h1>Environment Information</span></h1>
		<div id="displayctl">
			<button id="togglepower" onclick="togglepower();">Power</button>
			<button id="toggleenv" onclick="toggleenviron();">Environment</button>
			<button id="toggleraspi" onclick="toggleraspi();">Raspberry Pi</button>
		</div>
		<div id="power">
			<div><img id="powvoltage" src="assets/img/power.png"/></div>
			<div><img id="powcurrent" src="assets/img/power.png"/></div>
			<div><img id="powpower" src="assets/img/power.png"/></div>
		</div>
		<div id="environment">
			<div><img id="temperature" src="assets/img/environment.png" /></div>
			<div><img id="pressure" src="assets/img/environment.png" /></div>
			<div><img id="humidity" src="assets/img/environment.png" /></div>
		</div>
		<div id="raspi">
			<div><img id="raspipercentages" src="assets/img/raspi.png"/></div>
			<div><img id="raspiloads" src="assets/img/raspi.png"/></div>
			<div><img id="cputemp" src="assets/img/raspi.png"/></div>
		</div>
	</div>
	<script type="text/javascript">
	function toggleenviron() {
			document.getElementById("environment").style.display="block";
			document.getElementById("power").style.display="none";
			document.getElementById("raspi").style.display="none";
	}
	function togglepower() {
			document.getElementById("environment").style.display="none";
			document.getElementById("power").style.display="block";
			document.getElementById("raspi").style.display="none";
	}
	function toggleraspi() {
			document.getElementById("environment").style.display="none";
			document.getElementById("power").style.display="none";
			document.getElementById("raspi").style.display="block";
	}
	</script>
</body>
</html>